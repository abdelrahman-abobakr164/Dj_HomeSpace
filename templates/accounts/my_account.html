{% extends 'base.html' %}
{% load static %}

{% block title %}Settings{% endblock title %}

{% block body %}

  <main class="main">

    <div class="page-title light-background">
      <div class="container d-lg-flex justify-content-between align-items-center">
        <h1 class="mb-2 mb-lg-0">Settings</h1>
        <nav class="breadcrumbs">
          <ol>
            <li><a href='/' class='btn'>Home</a></li>
            <li class="current">Settings</li>
          </ol>
        </nav>
      </div>
    </div>

    <!-- Contact 2 Section -->
    <section id="contact-2" class="contact-2 section">

      <div class="container" data-aos="fade-up" data-aos-delay="100">
        <div class="row justify-content-center mb-5" data-aos="fade-up" data-aos-delay="200">
          <div class="col-lg-10">
            <div class="contact-form-wrapper">
              <h2 class="text-center">Account Settings</h2>
              <img id='preview' src="{{request.user.image.url}}" style='border-radius: 50%; max-height:200px; width:170px; margin-left:340px; ' class=' mb-4' alt="">

              <form  method="post" id="myaccountForm" enctype='multipart/form-data'>
                {% csrf_token %}

                <div class="row g-3">
                  <div class="col-md-12">
                    <div class="form-group">
                      <label for="id_image">Image:</label>
                      {{form.image}}
                      {% if form.image.errors %}
                        <ul>
                          {% for errors in form.image.errors %}
                            <li class='text-danger'>{{ errors }}</li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    </div>
                  </div>

                  <div class="col-md-12">
                    <div class="form-group">
                      <label for="id_username">Username:</label>
                      {{form.username}}
                      {% if form.username.errors %}
                        <ul>
                          {% for errors in form.username.errors %}
                            <li class='text-danger'>{{ errors }}</li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    </div>
                  </div>

                  <div class="col-md-12">
                    <div class="form-group">
                      <label for="id_phone">Phone Number:</label>
                      {{form.phone}}
                      {% if form.phone.errors %}
                        <ul>
                          {% for errors in form.phone.errors %}
                            <li class='text-danger'>{{ errors }}</li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    </div>
                  </div>

                  <div class="col-md-12">
                    <div class="form-group">
                      <label>Email Address:</label>
                      <input type="email" value='{{request.user.email}}' class='form-control' disabled>
                    </div>
                  </div>

                  <div class="d-flex mt-1'">
                    <a href="{% url 'account_email' %}" class='fw-600 font-xsss'>Change Email?</a>
                    <a href="{% url 'account_change_password' %}" style='margin-left:auto' class='fw-600 font-xsss'>Change Password?</a>
                  </div>

                  <div class="col-12 text-center">
                    <p class="text-danger text-center" id="id_ptag"></p>
                    <button type="submit" class="btn btn-dark w-100">Confirm</button>
                  </div>

                </div>
              </form>
            </div>
          </div>
        </div>

      </div>

    </section><!-- /Contact 2 Section -->

  </main>

{% endblock body %}


{% block script %}

<script>
  const imageInput = document.getElementById("id_image");
  const previewImg = document.getElementById("preview");

  imageInput.addEventListener("change", function () {
    const file = this.files[0]; // get the selected file
    if (file) {
      const reader = new FileReader();

      reader.onload = function (e) {
        previewImg.src = e.target.result; // set preview src
      };

      reader.readAsDataURL(file); // convert file to base64
    }
  });
</script>

{% endblock script %}